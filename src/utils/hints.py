"""
초보자 친화 힌트/설명 모듈
전문 용어에 대한 쉬운 설명을 제공하는 유틸리티 함수들
"""

# 기술적 지표 설명 (한글)
INDICATOR_HINTS = {
    # 가격/추세 지표
    "RSI": {
        "title": "RSI (상대강도지수)",
        "short": "주가가 과열됐는지, 저평가됐는지를 0~100 숫자로 보여줍니다.",
        "detail": """**RSI란?**
주가의 상승/하락 폭을 비교해서 '지금 너무 많이 올랐나?'를 판단하는 지표입니다.

📈 **해석 방법**:
- 30 이하: **과매도** (너무 많이 떨어져서 반등 가능성)
- 70 이상: **과매수** (너무 많이 올라서 하락 가능성)
- 30~70: 중립 (관망)

⚠️ 주의: 강한 추세에서는 RSI가 오랫동안 과매수/과매도 상태를 유지할 수 있습니다."""
    },
    
    "MACD": {
        "title": "MACD (이동평균수렴확산)",
        "short": "추세가 바뀌려는 징조를 감지하는 지표입니다.",
        "detail": """**MACD란?**
단기 이동평균과 장기 이동평균의 차이를 보여주는 지표입니다.

📈 **해석 방법**:
- MACD가 Signal선 위로 올라가면: **매수 신호** 🟢
- MACD가 Signal선 아래로 내려가면: **매도 신호** 🔴
- 히스토그램이 커지면: 추세가 강해지는 중

💡 팁: MACD는 RSI와 함께 보면 더 정확합니다."""
    },
    
    "ADX": {
        "title": "ADX (평균방향지수)",
        "short": "지금 추세가 강한지 약한지를 0~100 숫자로 보여줍니다.",
        "detail": """**ADX란?**
추세의 **방향이 아닌 강도**를 측정합니다. 오르든 내리든, 그 움직임이 얼마나 강한지!

📊 **해석 방법**:
- 0~25: 🔵 **약한 추세** (횡보장, 박스권)
- 25~50: 🟢 **강한 추세** (방향성 있음)
- 50~100: 🔴 **매우 강한 추세** (강력한 상승 또는 하락)

💡 팁: ADX가 낮을 때는 매매를 쉬고, 높을 때 추세를 따라가세요!"""
    },
    
    "VWAP": {
        "title": "VWAP (거래량가중평균가)",
        "short": "기관 투자자들의 평균 매입가 추정치입니다.",
        "detail": """**VWAP란?**
거래량을 고려한 하루 평균 가격입니다. 기관들이 '싸게 샀나, 비싸게 샀나'를 판단할 때 씁니다.

📈 **해석 방법**:
- 현재가 > VWAP: 기관 평균보다 비싸게 거래 중 (고평가 가능성)
- 현재가 < VWAP: 기관 평균보다 싸게 거래 중 (저평가 가능성)

💡 팁: 단타 매매자들이 진입/청산 기준으로 많이 씁니다."""
    },
    
    "OBV": {
        "title": "OBV (거래량균형)",
        "short": "거래량으로 큰손들의 매수/매도 힘을 추적합니다.",
        "detail": """**OBV란?**
주가가 오르면 거래량을 더하고, 내리면 빼는 누적 지표입니다.

📈 **해석 방법**:
- OBV 상승 + 주가 상승: 강한 매수세 ✅
- OBV 상승 + 주가 정체: 조용히 매집 중 (상승 임박?)
- OBV 하락 + 주가 정체: 조용히 매도 중 (하락 임박?)

💡 팁: '돈의 흐름'을 보는 지표라고 생각하세요!"""
    },
    
    # 변동성 지표
    "VIX": {
        "title": "VIX (공포지수)",
        "short": "시장 참여자들이 얼마나 불안해하는지 보여주는 지수입니다.",
        "detail": """**VIX란?**
S&P 500 옵션 가격에서 계산한 '기대 변동성'입니다. 불안하면 VIX가 오릅니다.

📊 **해석 방법**:
- VIX < 15: 🟢 **안정** (시장이 조용함)
- VIX 15~25: 🟡 **경계** (약간 불안)
- VIX 25~35: 🔴 **위험** (공포 확산)
- VIX > 35: 🟣 **극도 공포** (폭락장 가능성)

💡 역발상 팁: VIX가 너무 높으면 오히려 매수 기회일 수 있어요!"""
    },
    
    "ATR": {
        "title": "ATR (평균진폭)",
        "short": "하루에 주가가 평균적으로 얼마나 움직이는지 보여줍니다.",
        "detail": """**ATR이란?**
최근 14일간 하루 변동폭(고가-저가)의 평균입니다.

📊 **활용 방법**:
- 손절가 설정: 현재가 - (ATR × 2) = 손절 라인
- 변동성 큰 종목: ATR이 크면 위험하지만 수익 기회도 큼

💡 팁: ATR이 갑자기 커지면 큰 움직임이 시작되는 신호!"""
    },
    
    # 시장 폭 지표
    "breadth": {
        "title": "시장 폭 (Market Breadth)",
        "short": "지수는 오르는데, 실제로 오른 종목이 많은지 확인합니다.",
        "detail": """**시장 폭이란?**
지수(예: 코스피)만 보면 몇몇 대형주가 끌어올리는 건지 알기 어렵습니다.
시장 폭 지표는 '실제로 몇 종목이 올랐는지'를 봅니다.

📊 **해석 방법**:
- 상승 종목 > 하락 종목: 시장 전체가 건강 ✅
- 상승 종목 < 하락 종목: 대형주만 오름 (위험 신호) ⚠️

💡 팁: 지수가 신고가인데 상승 종목 수가 줄면 천장 근처일 수 있어요."""
    },
    
    # 펀더멘털 지표
    "PER": {
        "title": "PER (주가수익비율)",
        "short": "주가가 기업 수익 대비 몇 배인지 보여줍니다.",
        "detail": """**PER이란?**
주가 ÷ 주당순이익(EPS)입니다. '투자금 회수에 몇 년 걸리나?'를 의미합니다.

📊 **해석 방법**:
- PER 10: 현재 수익이 유지되면 10년 후 원금 회수
- PER < 10: 저평가 (싸다!)
- PER > 30: 고평가 (성장 기대가 반영됨)

⚠️ 주의: 업종마다 적정 PER이 다릅니다. IT는 높고, 금융은 낮은 게 정상."""
    },
    
    "ROE": {
        "title": "ROE (자기자본이익률)",
        "short": "내 돈으로 얼마나 돈을 벌어다 주는지 %로 표시합니다.",
        "detail": """**ROE란?**
순이익 ÷ 자기자본 × 100입니다. 회사가 주주 돈을 얼마나 효율적으로 굴리는지 보여줍니다.

📊 **해석 방법**:
- ROE > 15%: 🟢 훌륭한 수익성
- ROE 10~15%: 🟡 양호
- ROE < 10%: 🔴 개선 필요

💡 워런 버핏 기준: ROE 15% 이상인 회사에 투자하라!"""
    },
    
    # 포트폴리오/리스크
    "VaR": {
        "title": "VaR (최대예상손실)",
        "short": "최악의 경우 얼마까지 손해 볼 수 있는지 알려줍니다.",
        "detail": """**VaR이란?**
"95% 확률로 하루에 이 정도 이상은 안 잃습니다"를 계산한 값입니다.

📊 **예시**:
- VaR 5% = 1000만원 투자 시, 하루 최대 손실 50만원 예상

⚠️ 주의: 5%의 경악 상황에서는 VaR를 초과하는 손실이 발생할 수 있습니다!"""
    },
    
    "MDD": {
        "title": "MDD (최대낙폭)",
        "short": "고점에서 저점까지 최대 몇 % 빠졌는지 보여줍니다.",
        "detail": """**MDD란?**
투자 기간 중 최고점에서 최저점까지의 하락률입니다.

📊 **해석 방법**:
- MDD 10%: 1000만원이 한때 900만원까지 떨어졌음
- MDD 20% 이상: 심리적으로 버티기 힘듦

💡 팁: 자신이 감당할 수 있는 MDD를 미리 정해두세요!"""
    },
}


def get_hint_text(indicator: str, level: str = "short") -> str:
    """
    지표에 대한 힌트 텍스트 반환
    
    Args:
        indicator: 지표 키 (예: "RSI", "MACD")
        level: "short" (간단) 또는 "detail" (상세)
        
    Returns:
        힌트 텍스트
    """
    if indicator in INDICATOR_HINTS:
        return INDICATOR_HINTS[indicator].get(level, INDICATOR_HINTS[indicator]["short"])
    return f"{indicator}에 대한 설명이 없습니다."


def get_hint_title(indicator: str) -> str:
    """지표 제목 반환"""
    if indicator in INDICATOR_HINTS:
        return INDICATOR_HINTS[indicator].get("title", indicator)
    return indicator


def get_all_indicators() -> list:
    """모든 지표 키 목록 반환"""
    return list(INDICATOR_HINTS.keys())
